<div class="container">
  <div class="header-row" [title]="data.item.dishName || ''">
    {{ data.item.dishName || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è' }}
  </div>

  <img
    #photo
    *ngIf="data.item.hasImage && data.imageUrl"
    [src]="data.imageUrl"
    alt="–§–æ—Ç–æ –±–ª—é–¥–∞"
    class="photo"
    (load)="fitDialog()"
  />

  <div class="meta">
    <div class="meta-row">
      <span class="meta-left">{{ formatDateTime(data.item.createdAtUtc) }}</span>
      <span class="meta-right">–ö–∞–ª–æ—Ä–∏–∏: {{ data.item.caloriesKcal ?? '‚Äî' }} –∫–∫–∞–ª</span>
    </div>

    <div class="chips">
      <span class="chip">–ë {{ data.item.proteinsG ?? '‚Äî' }}</span>
      <span class="chip">–ñ {{ data.item.fatsG ?? '‚Äî' }}</span>
      <span class="chip">–£ {{ data.item.carbsG ?? '‚Äî' }}</span>
      <span class="chip" *ngIf="data.item.weightG">‚öñ {{ data.item.weightG }} –≥</span>
    </div>

    <div class="queued" *ngIf="data.item.updateQueued">–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è‚Ä¶</div>
  </div>

  <div class="ingredients" *ngIf="data.item.ingredients?.length">
    <span class="ingredients__icon" aria-hidden="true">üç£</span>
    <span class="ingredients__text">{{ data.item.ingredients.join(', ') }}</span>
  </div>

  <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ—Å—Ç–∞–≤–∞ -->
  <div *ngIf="(data.item.products?.length || 0) > 0" class="composition">
    <table mat-table [dataSource]="data.item.products" class="products-table mat-elevation-z1">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef class="h name">–ü—Ä–æ–¥—É–∫—Ç</th>
        <td mat-cell *matCellDef="let p" class="c name">{{ p.name }}</td>
      </ng-container>

      <ng-container matColumnDef="percent">
        <th mat-header-cell *matHeaderCellDef class="h num">%</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.percent == null ? '‚Äî' : (p.percent | number:'1.0-1') }}
        </td>
      </ng-container>

      <ng-container matColumnDef="grams">
        <th mat-header-cell *matHeaderCellDef class="h num">–≥</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.grams == null ? '‚Äî' : (p.grams | number:'1.0-0') }}
        </td>
      </ng-container>

      <ng-container matColumnDef="proteins_g">
        <th mat-header-cell *matHeaderCellDef class="h num">–ë</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.proteins_g == null ? '‚Äî' : (p.proteins_g | number:'1.0-1') }}
        </td>
      </ng-container>

      <ng-container matColumnDef="fats_g">
        <th mat-header-cell *matHeaderCellDef class="h num">–ñ</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.fats_g == null ? '‚Äî' : (p.fats_g | number:'1.0-1') }}
        </td>
      </ng-container>

      <ng-container matColumnDef="carbs_g">
        <th mat-header-cell *matHeaderCellDef class="h num">–£</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.carbs_g == null ? '‚Äî' : (p.carbs_g | number:'1.0-1') }}
        </td>
      </ng-container>

      <ng-container matColumnDef="calories_kcal">
        <th mat-header-cell *matHeaderCellDef class="h num">–∫–∫–∞–ª</th>
        <td mat-cell *matCellDef="let p" class="c num">
          {{ p.calories_kcal == null ? '‚Äî' : (p.calories_kcal | number:'1.0-0') }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns" class="row head"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="row"></tr>
    </table>
  </div>

  <div mat-dialog-actions align="end" class="actions">

    <button
      type="button"
      class="icon-button icon-button--danger"
      (click)="remove()"
      aria-label="–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å">
      <span aria-hidden="true">üóë</span>
    </button>
    <button
      type="button"
      class="icon-button icon-button--primary"
      (click)="openClarify()"
      aria-label="–£—Ç–æ—á–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å">
      <span aria-hidden="true">‚úé</span>
    </button>    
    <button
      type="button"
      class="icon-button icon-button--neutral"
      (click)="dialogRef.close()"
      aria-label="–ó–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥">
      <span aria-hidden="true">‚úï</span>
    </button>
  </div>
</div>
