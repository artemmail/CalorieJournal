<div class="camera-container">
  <div #previewBox id="cameraPreview" class="preview-box"></div>

  <div class="preview-overlay" *ngIf="previewActive">
    <div class="preview-hint">
      <mat-icon>info</mat-icon>
      <span>Наведите камеру на блюдо и нажмите на кнопку, чтобы сделать снимок.</span>
    </div>
    <div class="preview-controls">
      <button mat-mini-fab color="accent" (click)="openNoteDialog()" matTooltip="Добавить текст или голосовое описание" aria-label="Добавить описание">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-fab color="primary" (click)="captureFromPreview()" matTooltip="Сделать фото" aria-label="Сделать фото">
        <mat-icon>camera</mat-icon>
      </button>
      <button mat-mini-fab color="primary" (click)="takePhotoSystem()" matTooltip="Открыть системную камеру" aria-label="Системная камера">
        <mat-icon>photo_camera</mat-icon>
      </button>
    </div>
  </div>

  <div class="preview-overlay inactive" *ngIf="!previewActive">
    <div class="preview-hint">
      <mat-icon>warning</mat-icon>
      <span>Предпросмотр недоступен. Попробуйте включить его снова или воспользуйтесь системной камерой.</span>
    </div>
    <div class="preview-controls">
      <button mat-raised-button color="primary" (click)="retryPreview()">
        <mat-icon>autorenew</mat-icon>
        Повторить попытку
      </button>
      <button mat-stroked-button color="primary" (click)="takePhotoSystem()">
        <mat-icon>photo_camera</mat-icon>
        Системная камера
      </button>
      <button mat-mini-fab color="accent" (click)="openNoteDialog()" matTooltip="Добавить текст или голосовое описание" aria-label="Добавить описание">
        <mat-icon>edit</mat-icon>
      </button>
    </div>
  </div>
</div>

<mat-progress-bar *ngIf="uploadProgress !== null" [mode]="progressMode" [value]="uploadProgress"></mat-progress-bar>

<div class="last-shot" *ngIf="photoDataUrl">
  <img [src]="photoDataUrl" alt="snapshot" />
</div>
