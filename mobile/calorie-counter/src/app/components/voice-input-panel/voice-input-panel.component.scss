/* voice-input-panel.component.scss — полная версия */

/* ---------- Параметры ---------- */
:host {
  display: block;

  /* управляемые переменные */
  --mic-size: 44px;              /* диаметр кнопки микрофона */
  --mic-offset: 10px;            /* отступ справа/снизу от края поля */
  --safe-bottom: env(safe-area-inset-bottom, 0px);

  /* «запас» снизу, чтобы текст не заходил под кнопку */
  --mic-safe-space: calc(var(--mic-size) + var(--mic-offset) + var(--safe-bottom));
}

/* ---------- Контейнер ввода как в ChatGPT ---------- */
.chatgpt-input {
  position: relative;
  overflow: visible;
  border: 1px solid #e5e7eb;
  border-radius: 16px;
  background: #fff;
  padding: 12px 14px; /* без правого отступа под микрофон */
  transition: border-color .15s ease, box-shadow .15s ease, background-color .15s ease;

  &:focus-within {
    border-color: #d1d5db;
    box-shadow: 0 0 0 4px rgba(17, 24, 39, .06);
  }

  &--disabled {
    opacity: .6;
    pointer-events: none;
  }

  &--recording {
    border-color: #ef4444;
    box-shadow: 0 0 0 4px rgba(239, 68, 68, .12);
  }
}

/* ---------- Текстовая область ---------- */
.chatgpt-input__textarea {
  width: 100%;
  display: block;
  border: 0;
  outline: none;
  resize: none;
  background: transparent;
  color: inherit;
  font: inherit;
  line-height: 1.45;

  /* ключевое: оставляем пустое место снизу под микрофон */
  padding: 0 0 var(--mic-safe-space) 0;

  max-height: 50svh;
  overflow: auto;

  /* аккуратный скроллбар */
  &::-webkit-scrollbar { height: 10px; width: 10px; }
  &::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 8px; }
  &::-webkit-scrollbar-track { background: transparent; }
}

/* ---------- Кнопка микрофона ---------- */
/* фиксация в правом нижнем углу поверх текста */
.chatgpt-input__mic {
  position: absolute;
  right: var(--mic-offset);
  bottom: var(--mic-offset);
  z-index: 3;

  width: var(--mic-size);
  height: var(--mic-size);
  padding: 0;

  /* без «подложки», пока не нажато/не записывает */
  background: transparent !important;
  border: 0;
  box-shadow: none;
  color: inherit;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  /* прибираем лишние материалы от Angular Material */
  :where(.mat-mdc-button-touch-target) { width: var(--mic-size); height: var(--mic-size); }
  :where(.mdc-button__ripple) { display: none; }

  /* без подложки и на hover/focus/active */
  &:hover, &:focus, &:active {
    background: transparent !important;
    box-shadow: none;
  }
}

/* во время записи — явная подсветка микрофона */
.chatgpt-input--recording .chatgpt-input__mic {
  background: #ef4444 !important;
  color: #fff;
  border-radius: 9999px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, .12);
}

/* ---------- Подсказки под полем ---------- */
.chatgpt-input__hints {
  margin-top: 6px;
  font-size: 12px;
  line-height: 1.2;
  color: #6b7280;
}

.chatgpt-input__hint--recording {
  color: #ef4444;
}

/* ---------- Тёмная тема (опционально) ---------- */
@media (prefers-color-scheme: dark) {
  .chatgpt-input {
    background: #111214;
    border-color: #2a2d33;

    &:focus-within { box-shadow: 0 0 0 4px rgba(148, 163, 184, .10); }
  }

  .chatgpt-input__hints { color: #9aa3af; }
  .chatgpt-input--recording .chatgpt-input__mic { box-shadow: 0 2px 8px rgba(0, 0, 0, .35); }
}
