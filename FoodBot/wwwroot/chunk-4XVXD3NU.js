import{d as a,g as m}from"./chunk-HP2DYF7Y.js";var u=class extends m{start(e){return a(this,null,function*(){return new Promise((o,i)=>a(this,null,function*(){var s;yield navigator.mediaDevices.getUserMedia({audio:!e.disableAudio,video:!0}).then(t=>{t.getTracks().forEach(d=>d.stop())}).catch(t=>{i(t)});let r=document.getElementById("video"),n=document.getElementById(e.parent);if(r)i({message:"camera already started"});else{let t=document.createElement("video");t.id="video",t.setAttribute("class",e.className||""),e.position!=="rear"&&t.setAttribute("style","-webkit-transform: scaleX(-1); transform: scaleX(-1);");let d=navigator.userAgent.toLowerCase();if(d.includes("safari")&&!d.includes("chrome")&&(t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true")),n.appendChild(t),!((s=navigator.mediaDevices)===null||s===void 0)&&s.getUserMedia){let l={video:{width:{ideal:e.width},height:{ideal:e.height}}};e.position==="rear"?(l.video.facingMode="environment",this.isBackCamera=!0):this.isBackCamera=!1,navigator.mediaDevices.getUserMedia(l).then(function(c){t.srcObject=c,t.play(),o()},c=>{i(c)})}}}))})}startRecordVideo(){return a(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}stopRecordVideo(){return a(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}stop(){return a(this,null,function*(){let e=document.getElementById("video");if(e){e.pause();let i=e.srcObject.getTracks();for(let s of i)s.stop();e.remove()}})}capture(e){return a(this,null,function*(){return new Promise(o=>{let i=document.getElementById("video"),s=document.createElement("canvas"),r=s.getContext("2d");s.width=i.videoWidth,s.height=i.videoHeight,this.isBackCamera||(r.translate(i.videoWidth,0),r.scale(-1,1)),r.drawImage(i,0,0,i.videoWidth,i.videoHeight);let n;e.quality!=null?n=s.toDataURL("image/jpeg",e.quality/100).replace("data:image/jpeg;base64,",""):n=s.toDataURL("image/png").replace("data:image/png;base64,",""),o({value:n})})})}captureSample(e){return a(this,null,function*(){return this.capture(e)})}getSupportedFlashModes(){return a(this,null,function*(){throw new Error("getSupportedFlashModes not supported under the web platform")})}setFlashMode(e){return a(this,null,function*(){throw new Error("setFlashMode not supported under the web platform")})}flip(){return a(this,null,function*(){throw new Error("flip not supported under the web platform")})}setOpacity(e){return a(this,null,function*(){let o=document.getElementById("video");o&&e.opacity&&o.style.setProperty("opacity",e.opacity.toString())})}isCameraStarted(){return a(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}};export{u as CameraPreviewWeb};
